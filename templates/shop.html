{% extends "_base.html" %}
{% block title %}Marketplace — VFXKart{% endblock %}

{% block content %}

<style>
:root{
  --bg-dark:#0b1220;
  --card:#121b2e;
  --border:rgba(255,255,255,0.08);
  --accent:#38bdf8;
}

.market-wrap{padding-top:10px}

.market-head{
  text-align:center;
  margin:18px 0 26px;
}
.market-head h1{
  font-size:2.6rem;
  font-weight:700;
  margin:0;
}
.market-head p{
  margin-top:10px;
  color:#b6c2e2;
  font-size:1.05rem;
}

.filter-box{
  max-width:960px;
  margin:0 auto 30px;
  padding:22px;
  background:rgba(255,255,255,0.03);
  border:1px solid var(--border);
  border-radius:14px;
}

.filter-input, .filter-select{
  padding:12px;
  border-radius:10px;
  background:rgba(255,255,255,0.03);
  border:1px solid var(--border);
  color:white;
}

.btn-main{
  background:var(--accent);
  color:#020617;
  font-weight:700;
  border:none;
  padding:12px;
  border-radius:10px;
  cursor:pointer;
}
.btn-muted{
  background:#1f2937;
  color:#e5edff;
  font-weight:600;
  border-radius:10px;
  padding:12px;
  text-align:center;
  text-decoration:none;
}

.card{
  background:var(--card);
  border:1px solid var(--border);
  border-radius:14px;
  padding:16px;
  display:flex;
  flex-direction:column;
}
.card img{
  width:100%;
  height:180px;
  object-fit:contain;
  margin-bottom:12px;
}
.card h3{
  font-size:16px;
  font-weight:600;
  margin:0 0 4px;
}
.card p{
  font-size:13px;
  color:#9db3da;
  margin:0 0 10px;
}
.price{
  font-size:20px;
  font-weight:700;
  color:#38bdf8;
  margin-bottom:12px;
}
.card a{
  margin-top:auto;
  text-align:center;
  padding:10px;
  border-radius:8px;
  background:#38bdf8;
  color:#020617;
  font-weight:700;
  text-decoration:none;
}
</style>

<div class="market-wrap">

  <!-- HEADER -->
  <div class="market-head">
    <h1>Marketplace</h1>
    <p>Verified digital products from creators and partners.</p>
  </div>

  <!-- FILTERS -->
  <div class="filter-box">
    <form method="get" action="{{ url_for('shop') }}"
      style="display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:14px;">

      <input class="filter-input" type="text" name="q" placeholder="Search products"
        value="{{ query_args.q }}">

      <select name="seller" class="filter-select">
        <option value="">All sellers</option>
        {% for s in sellers %}
          <option value="{{ s }}" {% if query_args.seller==s %}selected{% endif %}>{{ s }}</option>
        {% endfor %}
      </select>

      <input class="filter-input" type="number" step="0.01" name="min_price"
        placeholder="Min price" value="{{ query_args.min_price }}">

      <input class="filter-input" type="number" step="0.01" name="max_price"
        placeholder="Max price" value="{{ query_args.max_price }}">

      <select name="sort" class="filter-select">
        <option value="newest" {% if query_args.sort=='newest' %}selected{% endif %}>Newest</option>
        <option value="price_asc" {% if query_args.sort=='price_asc' %}selected{% endif %}>Price ↑</option>
        <option value="price_desc" {% if query_args.sort=='price_desc' %}selected{% endif %}>Price ↓</option>
      </select>

      <button class="btn-main">Apply</button>
      <a href="{{ url_for('shop') }}" class="btn-muted">Reset</a>
    </form>
  </div>

  <!-- RESULTS -->
  <p style="text-align:center;color:#9fb7d4;margin-bottom:18px;">
    Showing {{ products|length }} of {{ total }} products
  </p>

  <!-- GRID -->
  <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:22px;">
    {% for product in products %}
      <div class="card">
        {% if product.image %}
          <img src="{{ product.image }}">
        {% else %}
          <div style="height:180px;background:#0f172a;border-radius:8px;margin-bottom:12px;"></div>
        {% endif %}

        <h3>{{ product.title }}</h3>
        <p>Seller: {{ product.seller }}</p>
        <div class="price">₹{{ product.price }}</div>

        <a href="{{ url_for('product_detail', product_id=product.id) }}">
          View product
        </a>
      </div>
    {% endfor %}
  </div>

  {% if products|length == 0 %}
    <p style="text-align:center;margin-top:40px;color:#8fa6cc;">
      No products found.
    </p>
  {% endif %}

</div>

{% endblock %}
